@page "/Users/UserListWithStations"
@inject UserService userService
@*@inject NavigationManager navigationManager*@

<div class="row border p-3">
	<h3 class="text-primary">User Summary</h3><hr />
		<div class="user-container">

		@foreach(var user in GetAllUsersAssignedToStations())
				{
					<div>
						<div>
							<label>User</label>
							User Id: @user.Id<br />
							First Name: @user.FirstName<br />
							Last Name: @user.LastName<br />
							Creation Data: @user.CreationDate<br />
						</div>
						<br /><br />

						<div>
							<label>Stations Assigned</label>
							@foreach(var station in user.StationsAssigned)
							{
								<div>
									Id: @station.Id<br />
									Name: @station.CallLetters<br />
									Owner: @station.Owner<br />
									Format: @station.Format<br />
								</div>
								<br /><br />
							}
						</div>
					</div>

					<br /><br />
				}

		</div>
</div>

<br /><br />

@*User Id Input: <input type="number" @bind="@UserId" @bind:event="oninput"/><br />
First Name: <input type="text" @bind="@FirstName" @bind:event="oninput"/><br />
Last Name: <input type="text" @bind="@LastName" @bind:event="oninput"/><br />
StationIds: <input type="text" @bind="@StationIds" @bind:event="oninput"/><br />*@

@code {
	public List<UserUiDTO> GetAllUsersAssignedToStations()
	{
		var response = userService.GetAllUsersAssignedToStations();

		var result = new List<UserUiDTO>();

		foreach (var user in response)
		{
			var newUser = new UserUiDTO()
				{
					Id = (int)user.Id,
					FirstName = user.FirstName,
					LastName = user.LastName,
					CreationDate = (DateTime)user.CreationDate,
					StationsAssigned = user.StationsAssigned
				}; 

			result.Add(newUser);
		}

		return result;
	}
}
